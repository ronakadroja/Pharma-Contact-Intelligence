import{c as ze,j as e,X as ce,r as n,b as xe,f as Re,g as De,B as ee,z as Le}from"./index-D21QH4JS.js";import{u as Be,F as Ee,M as ie}from"./useInfiniteScroll-DRbeSKyl.js";import{u as Fe,b as Ie,L as ue,B as $e,g as Me,c as Ve,d as pe,e as Te}from"./contacts-b_MSMaFs.js";import{c as he,a as fe,b as Ae,d as Pe,f as Oe}from"./combo-DQM6g1Mn.js";import{c as se,e as Ue,g as Ke,P as qe}from"./validation-jaXKceP2.js";import{a as He,T as Je}from"./Table-zsgj2JuY.js";import{M as We}from"./mail-58VknhIU.js";import{P as Xe}from"./phone-jAwAhGea.js";import{P as Ge}from"./plus-YAe2WIMc.js";import{S as Qe}from"./search-XKYGIuyy.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ze=ze("trash-2",Ye),de=({isOpen:t,title:v,message:F,confirmLabel:S="Confirm",cancelLabel:I="Cancel",confirmVariant:h="danger",onConfirm:y,onCancel:a})=>{if(!t)return null;const C=()=>{const c="px-4 py-2 text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2";switch(h){case"danger":return`${c} bg-red-600 text-white hover:bg-red-700 focus:ring-red-500`;case"warning":return`${c} bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500`;case"success":return`${c} bg-green-600 text-white hover:bg-green-700 focus:ring-green-500`;default:return`${c} bg-red-600 text-white hover:bg-red-700 focus:ring-red-500`}};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[e.jsx("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx(ce,{size:20})})}),e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:v}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:F})})]})}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse gap-2",children:[e.jsx("button",{type:"button",onClick:y,className:C(),children:S}),e.jsx("button",{type:"button",onClick:a,className:"mt-3 sm:mt-0 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:I})]})]})]})})},ne=({options:t,value:v,onChange:F,placeholder:S="Select an option",emptyMessage:I="No options found",disabled:h=!1,loading:y=!1,onClear:a,label:C,id:c,className:N="",allowCustomInput:_=!0})=>{const[$,R]=n.useState(!1),[j,M]=n.useState(""),[T,D]=n.useState(-1),[ae,O]=n.useState(""),[L,U]=n.useState(!1),u=n.useRef(null),G=n.useRef(null),A=t.filter(l=>l.name.toLowerCase().includes(j.toLowerCase())),H=t.find(l=>l.name===v),Q=!H&&v,p=H?H.name:Q?v:"",z=n.useCallback(()=>{console.log("handleBlur called",{searchTerm:j,allowCustomInput:_,isSelectingOption:L}),_&&j.trim()&&!L&&(console.log("Applying custom input:",j.trim()),F(j.trim()),O(j.trim())),R(!1),M(""),D(-1),U(!1)},[j,_,L,F]);n.useEffect(()=>{const l=w=>{u.current&&!u.current.contains(w.target)&&z()};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[z]);const J=l=>{if(!(h||y))switch(l.key){case"ArrowDown":l.preventDefault(),$?D(w=>w<A.length-1?w+1:0):R(!0);break;case"ArrowUp":l.preventDefault(),$&&D(w=>w>0?w-1:A.length-1);break;case"Enter":l.preventDefault(),$&&T>=0&&A[T]?P(A[T]):$?_&&j.trim()&&(F(j.trim()),O(j.trim()),R(!1),M("")):R(!0);break;case"Escape":l.preventDefault(),R(!1),M(""),D(-1);break;case"Tab":_&&j.trim()&&(F(j.trim()),O(j.trim())),R(!1),M(""),D(-1);break}},P=l=>{U(!0),F(l.name),O(""),R(!1),M(""),D(-1),setTimeout(()=>U(!1),100)},V=l=>{l.stopPropagation(),F(""),O(""),a&&a(),M("")},g=()=>{h||y||(R(!$),$||setTimeout(()=>{var l;return(l=G.current)==null?void 0:l.focus()},0))},W=l=>{const w=l.target.value;console.log("Input changed:",w),M(w),D(-1)};return e.jsxs("div",{className:`relative ${N}`,ref:u,children:[C&&e.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-neutral-700 mb-2",children:C}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-full border rounded-md px-3 py-2 pr-10 focus-within:outline-none focus-within:ring-1 transition-all bg-white cursor-pointer shadow-sm ${N!=null&&N.includes("border-red-300")?"border-red-300 focus-within:ring-red-500 focus-within:border-red-500":"border-gray-300 focus-within:ring-blue-500 focus-within:border-blue-500"} ${h||y?"bg-gray-50 cursor-not-allowed":""}`,onClick:g,children:$?e.jsx("input",{ref:G,type:"text",value:j,onChange:W,onKeyDown:J,onBlur:z,placeholder:_?"Search or type custom value...":"Search...",className:"w-full outline-none bg-transparent text-sm",disabled:h||y}):e.jsxs("span",{className:`text-sm ${p?"text-gray-900":"text-gray-400"}`,children:[y?"Loading...":p||S,Q&&_&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(custom)"})]})}),e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[v&&!h&&!y&&e.jsx("button",{onClick:V,className:"text-neutral-400 hover:text-neutral-600 transition-colors p-1",title:"Clear selection",children:e.jsx(ce,{size:14})}),e.jsx(He,{className:`text-neutral-400 transition-transform ${$?"rotate-180":""}`,size:18})]}),$&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:y?e.jsx("div",{className:"px-4 py-3 text-sm text-neutral-500",children:"Loading..."}):e.jsx(e.Fragment,{children:A.length>0?A.map((l,w)=>e.jsx("div",{className:`px-3 py-2 text-sm cursor-pointer transition-colors ${w===T?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"} ${v===l.name?"bg-blue-100 text-blue-800 font-medium":""}`,onMouseDown:te=>{te.preventDefault(),U(!0)},onClick:()=>P(l),onMouseEnter:()=>D(w),children:l.name},l.id)):e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:_&&j?e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500 mb-2",children:I}),e.jsxs("div",{className:"text-blue-600 font-medium",children:['Click outside to use "',j,'" as custom value']})]}):I})})})]})]})},es=({contact:t,onSuccess:v,onCancel:F})=>{const{success:S,error:I}=xe(),[h,y]=n.useState(!1),[a,C]=n.useState({}),[c,N]=n.useState({}),[_,$]=n.useState([]),[R,j]=n.useState([]),[M,T]=n.useState([]),[D,ae]=n.useState([]),[O,L]=n.useState(!1),[U,u]=n.useState(!1),[G,A]=n.useState(!1),[H,Q]=n.useState(!1),[p,z]=n.useState({company_name:(t==null?void 0:t.company_name)||"",person_name:(t==null?void 0:t.person_name)||"",department:(t==null?void 0:t.department)||"",designation:(t==null?void 0:t.designation)||"",product_type:(t==null?void 0:t.product_type)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",city:(t==null?void 0:t.city)||"",person_country:(t==null?void 0:t.person_country)||"",company_country:(t==null?void 0:t.company_country)||"",region:(t==null?void 0:t.region)||"",reference:(t==null?void 0:t.reference)||"",person_linkedin_url:(t==null?void 0:t.person_linkedin_url)||"",company_linkedin_url:(t==null?void 0:t.company_linkedin_url)||"",company_website:(t==null?void 0:t.company_website)||"",status:(t==null?void 0:t.status)||"Active",is_verified:(t==null?void 0:t.is_verified)||0});n.useEffect(()=>{(async()=>{L(!0);try{const r=await he();$(r)}catch(r){console.error("Failed to load countries:",r)}finally{L(!1)}u(!0);try{const r=await fe();j(r)}catch(r){console.error("Failed to load departments:",r)}finally{u(!1)}A(!0);try{const r=await Ae();T(r)}catch(r){console.error("Failed to load product types:",r)}finally{A(!1)}Q(!0);try{const r=await Pe();ae(r)}catch(r){console.error("Failed to load regions:",r)}finally{Q(!1)}})()},[]),n.useEffect(()=>{z(t?{company_name:t.company_name||"",person_name:t.person_name||"",department:t.department||"",designation:t.designation||"",product_type:t.product_type||"",email:t.email||"",phone:t.phone||"",city:t.city||"",person_country:t.person_country||"",company_country:t.company_country||"",region:t.region||"",reference:t.reference||"",person_linkedin_url:t.person_linkedin_url||"",company_linkedin_url:t.company_linkedin_url||"",company_website:t.company_website||"",status:t.status||"Active",is_verified:t.is_verified||0}:{company_name:"",person_name:"",department:"",designation:"",product_type:"",email:"",phone:"",city:"",person_country:"",company_country:"",region:"",reference:"",person_linkedin_url:"",company_linkedin_url:"",company_website:"",status:"Active",is_verified:0}),C({}),N({})},[t]);const J=(o,r,d=!1)=>{if(!o.trim()&&!d)return"";if(!o.trim()&&d)return`${r} is required`;try{return new URL(o),""}catch{return`Please enter a valid ${r.toLowerCase()}`}},P=["company_name","person_name","person_country","department"],V=(o,r)=>{switch(o){case"company_name":return se(r,"Company name").error||"";case"person_name":return se(r,"Person name").error||"";case"department":return se(r,"Department").error||"";case"designation":return"";case"product_type":return"";case"email":return r&&Ke(r).error||"";case"phone":return r&&Ue(r).error||"";case"person_country":return se(r,"Person country").error||null;case"company_country":return se(r,"company country").error||null;case"company_linkedin_url":return J(r,"Company LinkedIn URL",!1);case"company_website":return J(r,"Company website",!1);case"person_linkedin_url":return J(r,"Personal LinkedIn URL",!1);case"status":return se(r,"Status").error||"";default:return""}},g=()=>{const o={};return Object.keys(p).forEach(r=>{const d=p[r],i=typeof d=="string"?d:String(d),b=typeof d=="string"?d.trim()!=="":d!=null;if(P.includes(r)||b){const Y=V(r,i);Y&&(o[r]=Y)}}),C(o),Object.keys(o).length===0},W=(o,r)=>{z(i=>({...i,[r]:o})),N(i=>({...i,[r]:!0}));const d=V(r,o);C(i=>({...i,[r]:d}))},l=o=>{z(d=>({...d,department:o})),N(d=>({...d,department:!0}));const r=V("department",o);C(d=>({...d,department:r}))},w=o=>{z(d=>({...d,product_type:o})),N(d=>({...d,product_type:!0}));const r=V("product_type",o);C(d=>({...d,product_type:r}))},te=o=>{z(d=>({...d,region:o})),N(d=>({...d,region:!0}));const r=V("region",o);C(d=>({...d,region:r}))},B=o=>{const{name:r,value:d}=o.target;if(z(i=>({...i,[r]:r==="is_verified"?Number(d):d})),N(i=>({...i,[r]:!0})),c[r]||d){const i=V(r,d);C(b=>({...b,[r]:i}))}},k=o=>{const{name:r,value:d}=o.target;N(b=>({...b,[r]:!0}));const i=V(r,d);C(b=>({...b,[r]:i}))},le=async o=>{var d;o.preventDefault();const r=Object.keys(p);if(N(r.reduce((i,b)=>({...i,[b]:!0}),{})),!g()){I("Please fix the validation errors before submitting",{title:"Validation Error",persistent:!1});return}y(!0);try{const i={...p};t?(await Fe(t.id,i),S("Contact updated successfully!",{title:"Success",actions:[{label:"View Contacts",onClick:()=>console.log("Navigate to contacts"),variant:"primary"}]})):(await Ie(i),S("Contact added successfully!",{title:"Success",actions:[{label:"Add Another",onClick:()=>window.location.reload(),variant:"primary"}]})),v==null||v()}catch(i){console.error("Contact creation/update error:",i);let b=`Failed to ${t?"update":"add"} contact`;const Y=(d=i==null?void 0:i.response)==null?void 0:d.status;let re=!1;if(i){if(i.success===!1&&i.error&&typeof i.error=="object"){const K=i.error;console.log(K);const Z={};Object.keys(K).forEach(E=>{const q=K[E];Array.isArray(q)&&q.length>0&&(Z[E]=q[0])}),C(E=>({...E,...Z}));const oe=Object.keys(Z).reduce((E,q)=>(E[q]=!0,E),{});N(E=>({...E,...oe})),I("Please fix the validation errors and try again",{title:"Validation Error",duration:8e3,actions:[{label:"Fix Errors",onClick:()=>{y(!1);const E=Object.keys(Z)[0];if(E){const q=document.getElementById(E);q&&q.focus()}},variant:"primary"}]});return}i.response.data.error&&typeof i.response.data.error=="string"?(b=i.response.data.error,re=b.toLowerCase().includes("already exists")||b.toLowerCase().includes("duplicate")||b.toLowerCase().includes("unique constraint")):i.response.data.message?b=i.response.data.message:typeof i.response.data=="string"&&(b=i.response.data)}else i!=null&&i.message&&(b=i.message);Y===422&&re?I(b,{title:"Contact Already Exists",duration:1e4,actions:[{label:"Change Email",onClick:()=>{const K=document.getElementById("email");K&&(K.focus(),K.select()),y(!1)},variant:"primary"},{label:"Clear Form",onClick:()=>{window.location.reload()},variant:"secondary"}]}):Y===422?I(b,{title:"Validation Error",duration:8e3,actions:[{label:"Fix & Retry",onClick:()=>{y(!1)},variant:"primary"}]}):I(b,{title:"Error",duration:8e3,actions:[{label:"Try Again",onClick:()=>{y(!1)},variant:"primary"}]})}finally{y(!1)}};return e.jsxs("div",{className:"bg-white h-full flex flex-col max-h-full",children:[e.jsxs("div",{className:"flex-shrink-0 bg-white border-b border-gray-200 p-6 pb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Contact":"Add New Contact"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:t?"Update the contact information below.":"Fill in the information below to add a new contact."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:e.jsx("form",{id:"contact-form",onSubmit:le,className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_name",className:"block text-sm font-medium text-gray-700",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"company_name",name:"company_name",value:p.company_name,onChange:B,onBlur:k,required:!0,placeholder:"Enter company name",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.company_name&&a.company_name?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.company_name&&a.company_name&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.company_name]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"product_type",className:"block text-sm font-medium text-gray-700",children:"Product Type"}),e.jsx(ne,{id:"product_type",options:M,value:p.product_type,onChange:w,placeholder:"Select or enter product type",emptyMessage:"No product types found. Type a custom product type and click outside to use it.",disabled:h,loading:G,allowCustomInput:!0,className:`mt-1 ${c.product_type&&a.product_type?"border-red-300":""}`}),c.product_type&&a.product_type&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.product_type]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company_website",className:"block text-sm font-medium text-gray-700",children:"Company Website"}),e.jsx("input",{type:"url",id:"company_website",name:"company_website",value:p.company_website,onChange:B,onBlur:k,placeholder:"Enter company website",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.company_website&&a.company_website?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.company_website&&a.company_website&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.company_website]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company_linkedin_url",className:"block text-sm font-medium text-gray-700",children:"Company LinkedIn URL"}),e.jsx("input",{type:"url",id:"company_linkedin_url",name:"company_linkedin_url",value:p.company_linkedin_url,onChange:B,onBlur:k,placeholder:"Enter company LinkedIn URL",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.company_linkedin_url&&a.company_linkedin_url?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.company_linkedin_url&&a.company_linkedin_url&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.company_linkedin_url]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company_country",className:"block text-sm font-medium text-gray-700",children:"Company Country"}),e.jsx(ne,{id:"company_country",options:_,value:p.company_country,onChange:o=>W(o,"company_country"),placeholder:"Select company country",emptyMessage:"No countries found",disabled:h,loading:O,allowCustomInput:!1,className:`mt-1 ${c.company_country&&a.company_country?"border-red-300":""}`}),c.company_country&&a.company_country&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.company_country]})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Person Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"person_name",className:"block text-sm font-medium text-gray-700",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"person_name",name:"person_name",value:p.person_name,onChange:B,onBlur:k,required:!0,placeholder:"Enter full name",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.person_name&&a.person_name?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.person_name&&a.person_name&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.person_name]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:p.email,onChange:B,onBlur:k,placeholder:"Enter email address",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.email&&a.email?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.email&&a.email&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.email]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:p.phone,onChange:B,onBlur:k,placeholder:"Enter phone number",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.phone&&a.phone?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.phone&&a.phone&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.phone]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"person_linkedin_url",className:"block text-sm font-medium text-gray-700",children:"LinkedIn URL"}),e.jsx("input",{type:"url",id:"person_linkedin_url",name:"person_linkedin_url",value:p.person_linkedin_url,onChange:B,onBlur:k,placeholder:"Enter LinkedIn URL",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.person_linkedin_url&&a.person_linkedin_url?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.person_linkedin_url&&a.person_linkedin_url&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.person_linkedin_url]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ne,{id:"department",options:R,value:p.department,onChange:l,placeholder:"Select or enter department",emptyMessage:"No departments found. Type a custom department and click outside to use it.",disabled:h,loading:U,allowCustomInput:!0,className:`mt-1 ${c.department&&a.department?"border-red-300":""}`}),c.department&&a.department&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.department]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"designation",className:"block text-sm font-medium text-gray-700",children:"Designation"}),e.jsx("input",{type:"text",id:"designation",name:"designation",value:p.designation,onChange:B,onBlur:k,placeholder:"Enter designation",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.designation&&a.designation?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.designation&&a.designation&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.designation]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"person_country",className:"block text-sm font-medium text-gray-700",children:["Country ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ne,{id:"person_country",options:_,value:p.person_country,onChange:o=>W(o,"person_country"),placeholder:"Select person country",emptyMessage:"No countries found",disabled:h,loading:O,allowCustomInput:!1,className:`mt-1 ${c.person_country&&a.person_country?"border-red-300":""}`}),c.person_country&&a.person_country&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.person_country]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:p.city,onChange:B,placeholder:"Enter city",className:"mt-1 block w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"region",className:"block text-sm font-medium text-gray-700",children:"Region"}),e.jsx(ne,{id:"region",options:D,value:p.region,onChange:te,placeholder:"Select or enter region",emptyMessage:"No regions found. Type a custom region and click outside to use it.",disabled:h,loading:H,allowCustomInput:!0,className:`mt-1 ${c.region&&a.region?"border-red-300":""}`}),c.region&&a.region&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.region]})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reference",className:"block text-sm font-medium text-gray-700",children:"Reference Source"}),e.jsx("input",{type:"text",id:"reference",name:"reference",value:p.reference,onChange:B,onBlur:k,placeholder:"Enter reference source",className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.reference&&a.reference?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),c.reference&&a.reference&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.reference]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"status",name:"status",value:p.status,onChange:B,onBlur:k,required:!0,className:`mt-1 block w-full px-3 py-2 text-sm border rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${c.status&&a.status?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),c.status&&a.status&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.status]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"is_verified",className:"block text-sm font-medium text-gray-700",children:"Verification Status"}),e.jsxs("select",{id:"is_verified",name:"is_verified",value:p.is_verified,onChange:B,className:"mt-1 block w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:0,children:"Not Verified"}),e.jsx("option",{value:1,children:"Verified"})]})]})]})]})]})})}),e.jsx("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 p-6 shadow-lg",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:F,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"submit",form:"contact-form",disabled:h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:h?"Saving...":t?"Update Contact":"Add Contact"})]})})]})},ss=10,us=()=>{const[t,v]=n.useState([]),[F,S]=n.useState(1),[I,h]=n.useState(!0),[y,a]=n.useState(!0),[C,c]=n.useState(0),[N,_]=n.useState(!1),[$,R]=n.useState(null),[j,M]=n.useState(!1),[T,D]=n.useState(null),[ae,O]=n.useState([]),[L,U]=n.useState({}),{showToast:u}=xe(),G=n.useRef(null),[A,H]=n.useState(!1),[Q,p]=n.useState(!1),[z,J]=n.useState(null),[P,V]=n.useState(!1),[g,W]=n.useState({company_name:[],department:[],person_country:[]}),[l,w]=n.useState({companies:[],departments:[],countries:[],isLoaded:!1,isLoading:!1}),[te,B]=n.useState(()=>{const s=localStorage.getItem("adminSidebarCollapsed");return s?JSON.parse(s):!1}),k=n.useRef(!1);n.useEffect(()=>{const s=()=>{const f=localStorage.getItem("adminSidebarCollapsed"),x=f?JSON.parse(f):!1;B(X=>X!==x?x:X)};window.addEventListener("storage",s);const m=setInterval(s,200);return()=>{window.removeEventListener("storage",s),clearInterval(m)}},[]);const le=n.useMemo(()=>[{accessorKey:"company_name",header:"Company",size:200,cell:({row:s})=>e.jsxs("div",{className:"min-w-0 max-w-[200px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 truncate",children:s.original.company_name}),s.original.company_linkedin_url&&e.jsx("a",{href:s.original.company_linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors flex-shrink-0",title:"View Company LinkedIn",children:e.jsx(ue,{size:14})})]}),s.original.company_website&&e.jsx("div",{className:"text-xs text-blue-600 hover:text-blue-800 transition-colors truncate",children:s.original.company_website}),s.original.company_type&&e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Type: ",s.original.company_type]})]})},{accessorKey:"person_name",header:"Contact Person",size:180,cell:({row:s})=>e.jsxs("div",{className:"min-w-0 max-w-[180px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 truncate",children:s.original.person_name}),s.original.person_linkedin_url&&e.jsx("a",{href:s.original.person_linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors flex-shrink-0",title:"View LinkedIn Profile",children:e.jsx(ue,{size:14})})]}),e.jsx("div",{className:"text-xs text-gray-600 truncate",children:s.original.designation})]})},{accessorKey:"contact_info",header:"Contact Info",size:220,cell:({row:s})=>e.jsx("div",{className:"min-w-0 max-w-[220px]",children:e.jsxs("div",{className:"space-y-1",children:[s.original.email&&e.jsxs("a",{href:`mailto:${s.original.email}`,className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:underline group",title:s.original.email,children:[e.jsx(We,{size:12,className:"text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.original.email}),s.original.is_professional_email&&e.jsx("div",{title:"Professional Email",children:e.jsx($e,{size:12,className:"text-green-700 flex-shrink-0"})})]}),s.original.phone&&e.jsxs("a",{href:`tel:${s.original.phone}`,className:"flex items-center gap-1 text-xs text-green-600 hover:text-green-800 hover:underline group",title:s.original.phone,children:[e.jsx(Xe,{size:12,className:"text-green-500 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.original.phone})]})]})})},{accessorKey:"is_verified",header:"Status",size:100,cell:({row:s})=>{const m=s.original.is_verified===1;return e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium transition-colors ${m?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[m?e.jsx(Re,{size:10,className:"mr-1"}):e.jsx(De,{size:10,className:"mr-1"}),m?"Verified":"Unverified"]})})}},{accessorKey:"department",header:"Department",size:160,cell:({row:s})=>e.jsx("div",{className:"min-w-0 max-w-[160px]",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate mb-1",title:s.original.department,children:s.original.department})})},{accessorKey:"product_type",header:"Product Type",size:140,cell:({row:s})=>e.jsx("div",{className:"min-w-0 max-w-[140px]",children:e.jsx("div",{className:"text-sm text-gray-900 truncate",title:s.original.product_type,children:s.original.product_type})})},{accessorKey:"person_country",header:"Person Country",size:150,cell:({row:s})=>e.jsxs("div",{className:"min-w-0 max-w-[150px]",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate mb-1",title:s.original.person_country,children:s.original.person_country}),s.original.city&&e.jsx("div",{className:"text-xs text-gray-600 truncate",title:s.original.city,children:s.original.city})]})},{accessorKey:"company_country",header:"Company Country",size:150,cell:({row:s})=>e.jsx("div",{className:"min-w-0 max-w-[150px]",children:e.jsx("div",{className:"text-sm text-gray-900 truncate",title:s.original.company_country,children:s.original.company_country||"N/A"})})},{accessorKey:"region",header:"Region",size:120,cell:({row:s})=>e.jsx("div",{className:"min-w-0 max-w-[120px]",children:e.jsx("div",{className:"text-sm text-gray-900 truncate",title:s.original.region,children:s.original.region||"N/A"})})},{id:"actions",header:"Actions",size:120,cell:({row:s})=>e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>ge(s.original),className:"text-blue-600 hover:text-blue-800",title:"Edit contact",children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ye(s.original),className:"text-red-600 hover:text-red-800",title:"Delete contact",children:e.jsx(Ze,{className:"h-4 w-4"})})]})}],[]),o=n.useCallback(async(s=1,m=!1,f=!1)=>{try{m||a(!0);const x=await Me({page:s,per_page:ss,company_name:g.company_name,department:g.department,person_country:g.person_country});m?v(X=>[...X,...x.data]):(v(x.data),S(1)),c(x.total),h(x.current_page<x.last_page),f&&u("Contact data loaded successfully","success")}catch(x){console.error("Error fetching contacts:",x),u("Failed to fetch contacts","error"),m||(v([]),c(0),h(!1))}finally{m||a(!1)}},[u,g.company_name,g.department,g.person_country]),r=n.useCallback(async()=>{if(!k.current){k.current=!0,console.log("Loading combo data..."),w(s=>({...s,isLoading:!0}));try{const[s,m,f]=await Promise.all([Oe(),fe(),he()]);w({companies:s||[],departments:m||[],countries:f||[],isLoaded:!0,isLoading:!1})}catch(s){console.error("Failed to load combo data:",s),u("Failed to load filter options. Please try again.","error"),w(m=>({...m,isLoading:!1})),k.current=!1}}},[u]),d=n.useCallback(async()=>{const s=F+1;S(s),await o(s,!0)},[F,o]),{isLoadingMore:i,containerRef:b,tableScrollRef:Y}=Be(d,{threshold:500,enabled:!y&&I,isLoading:y,hasMore:I,useTableScroll:!0});n.useEffect(()=>{console.log("Filter visibility changed:",{showFilters:P,comboLoadingInitiated:k.current}),P&&!k.current&&(console.log("Triggering combo data load..."),r())},[P,r]),n.useEffect(()=>{o(1,!1)},[]);const re=n.useCallback(s=>{const m=s.map(f=>f.name);W(f=>({...f,company_name:m}))},[]),K=n.useCallback(s=>{const m=s.map(f=>f.name);W(f=>({...f,department:m}))},[]),Z=n.useCallback(s=>{const m=s.map(f=>f.name);W(f=>({...f,person_country:m}))},[]),oe=n.useCallback(async()=>{S(1),v([]),h(!0),await o(1,!1,!1),V(!1);const s=g.company_name.length+g.department.length+g.person_country.length;s>0?u(`Applied ${s} filter${s!==1?"s":""}`,"success"):u("Search completed","success")},[g,u,o]),E=n.useCallback(()=>{W({company_name:[],department:[],person_country:[]}),V(!1),u("Filters cleared","success")},[u]),q=()=>{R(null),_(!0)},ge=s=>{R(s),_(!0)},ye=s=>{D(s),M(!0)},be=async()=>{if(T)try{await pe(T.id),u("Contact deleted successfully!","success"),S(1),v([]),h(!0),o(1,!1,!1)}catch(s){u(s instanceof Error?s.message:"Failed to delete contact","error")}finally{M(!1),D(null)}},ve=async s=>{var f;console.log("Bulk upload triggered",s.target.files);const m=(f=s.target.files)==null?void 0:f[0];if(m){console.log("File selected:",m.name,m.type,m.size);try{u("Bulk upload started. Processing file...","success");const x=await Ve(m);if(x.file&&Array.isArray(x.file)&&x.file.length>0){u(x.file[0],"error");return}else if(x.file&&typeof x.file=="string"){u(x.file,"error");return}x.success!==void 0&&(x.failure===0?u(`Successfully imported all ${x.success} contacts!`,"success"):(u(`Imported ${x.success} contacts with ${x.failure} failures. Check error details below.`,"error"),x.erros&&x.erros.length>0&&x.erros.forEach(X=>{var me;const Se=`Row ${X.row}: ${X.message.includes("SQLSTATE[23000]")?`Missing required field: ${((me=X.message.match(/Column '(.+?)' cannot/))==null?void 0:me[1])||"unknown field"}`:X.message}`;u(Se,"error")})),S(1),v([]),h(!0),o(1,!1,!1))}catch(x){u(x.file[0],"error")}finally{s.target.value=""}}},je=()=>{var s;console.log("Bulk upload button clicked"),(s=G.current)==null||s.click()},we=()=>{_(!1),R(null),S(1),v([]),h(!0),o(1,!1,!1)},_e=()=>{H(!0)},Ce=async()=>{try{const s=Object.entries(L).filter(([m,f])=>f).map(([m])=>m);await Promise.all(s.map(m=>pe(m))),u(`Successfully deleted ${s.length} contacts!`,"success"),U({}),S(1),v([]),h(!0),o(1,!1,!1)}catch(s){u(s instanceof Error?s.message:"Failed to delete contacts","error")}finally{H(!1)}},Ne=s=>{J(s),p(!0)},ke=async()=>{if(z)try{const s=Object.entries(L).filter(([m,f])=>f).map(([m])=>m);await Promise.all(s.map(m=>Te(m,z))),u(`Successfully updated status for ${s.length} contacts!`,"success"),U({}),S(1),v([]),h(!0),o(1,!1,!1)}catch(s){u(s instanceof Error?s.message:"Failed to update contact status","error")}finally{p(!1),J(null)}};return e.jsx("div",{className:"fixed inset-0 top-16 bg-gray-50 overflow-hidden transition-all duration-300 ease-in-out",style:{left:`${te?"64px":"256px"}`},ref:b,children:e.jsx("div",{className:"h-full p-6",children:e.jsxs("div",{className:"flex flex-col bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden h-full",children:[e.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Contact Management"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Manage pharmaceutical industry contacts (",C.toLocaleString()," total contacts)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:G,type:"file",accept:".csv,.xlsx,.xls",onChange:ve,className:"hidden",title:"Upload CSV or Excel file"}),e.jsxs(ee,{onClick:()=>V(!P),icon:e.jsx(Ee,{size:18}),type:"button",size:"sm",variant:P?"primary":"outline",children:[e.jsx("span",{className:"hidden sm:inline",children:"Filters"}),e.jsx("span",{className:"sm:hidden",children:"Filter"})]}),e.jsxs(ee,{onClick:je,icon:e.jsx(Le,{size:18}),type:"button",size:"sm",variant:"outline",children:[e.jsx("span",{className:"hidden sm:inline",children:"Bulk Upload"}),e.jsx("span",{className:"sm:hidden",children:"Upload"})]}),e.jsxs(ee,{onClick:q,icon:e.jsx(Ge,{size:18}),size:"sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Add Contact"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})}),P&&e.jsxs("div",{className:"flex-shrink-0 bg-gray-50 border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Company Name"}),e.jsx(ie,{options:l.companies,selectedValues:l.companies.filter(s=>g.company_name.includes(s.name)),onSelect:re,onRemove:re,displayValue:"name",placeholder:l.isLoading?"Loading companies...":"Search and select company names...",emptyRecordMsg:l.isLoading?"Loading companies...":"No companies found. Try a different search term.",showCheckbox:!0,closeIcon:"cancel",showArrow:!0,disable:l.isLoading,style:{chips:{background:"#3B82F6",color:"white",fontSize:"12px",borderRadius:"4px",padding:"2px 6px",margin:"1px"},searchBox:{border:"1px solid #D1D5DB",borderRadius:"6px",padding:"8px",fontSize:"14px",backgroundColor:"white",width:"100%"},multiselectContainer:{backgroundColor:"white",zIndex:9999,width:"100%"},option:{color:"#374151",backgroundColor:"white",padding:"8px 12px",width:"100%"},optionContainer:{border:"1px solid #D1D5DB",borderRadius:"6px",maxHeight:"200px",zIndex:9999,position:"absolute",backgroundColor:"white",width:"100%"}}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Department"}),e.jsx(ie,{options:l.departments,selectedValues:l.departments.filter(s=>g.department.includes(s.name)),onSelect:K,onRemove:K,displayValue:"name",placeholder:l.isLoading?"Loading departments...":"Search and select departments...",emptyRecordMsg:l.isLoading?"Loading departments...":"No departments found. Try a different search term.",showCheckbox:!0,closeIcon:"cancel",showArrow:!0,disable:l.isLoading,style:{chips:{background:"#F59E0B",color:"white",fontSize:"12px",borderRadius:"4px",padding:"2px 6px",margin:"1px"},searchBox:{border:"1px solid #D1D5DB",borderRadius:"6px",padding:"8px",fontSize:"14px",backgroundColor:"white",width:"100%"},multiselectContainer:{backgroundColor:"white",zIndex:9999,width:"100%"},option:{color:"#374151",backgroundColor:"white",padding:"8px 12px",width:"100%"},optionContainer:{border:"1px solid #D1D5DB",borderRadius:"6px",maxHeight:"200px",zIndex:9999,position:"absolute",backgroundColor:"white",width:"100%"}}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Person Country"}),e.jsx(ie,{options:l.countries,selectedValues:l.countries.filter(s=>g.person_country.includes(s.name)),onSelect:Z,onRemove:Z,displayValue:"name",placeholder:l.isLoading?"Loading countries...":"Search and select person countries...",emptyRecordMsg:l.isLoading?"Loading countries...":"No countries found. Try a different search term.",showCheckbox:!0,closeIcon:"cancel",showArrow:!0,disable:l.isLoading,style:{chips:{background:"#8B5CF6",color:"white",fontSize:"12px",borderRadius:"4px",padding:"2px 6px",margin:"1px"},searchBox:{border:"1px solid #D1D5DB",borderRadius:"6px",padding:"8px",fontSize:"14px",backgroundColor:"white",width:"100%"},multiselectContainer:{backgroundColor:"white",zIndex:9999,width:"100%"},option:{color:"#374151",backgroundColor:"white",padding:"8px 12px",width:"100%"},optionContainer:{border:"1px solid #D1D5DB",borderRadius:"6px",maxHeight:"200px",zIndex:9999,position:"absolute",backgroundColor:"white",width:"100%"}}})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{const s=g.company_name.length+g.department.length+g.person_country.length;return s>0?e.jsxs("span",{className:"text-blue-600 font-medium",children:[s," filter(s) selected"]}):e.jsx("span",{children:"No filters selected"})})()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{onClick:E,variant:"outline",size:"sm",icon:e.jsx(ce,{size:16}),disabled:g.company_name.length===0&&g.department.length===0&&g.person_country.length===0,children:"Clear All"}),e.jsx(ee,{onClick:oe,size:"sm",icon:e.jsx(Qe,{size:16}),disabled:y,children:y?"Searching...":"Search"})]})]})]}),Object.entries(L).filter(([,s])=>s).length>0&&e.jsx("div",{className:"flex-shrink-0 bg-blue-50 border-b border-blue-200 px-6 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[Object.entries(L).filter(([,s])=>s).length," contacts selected"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs("select",{onChange:s=>Ne(s.target.value),className:"text-sm px-3 py-2 border border-gray-300 rounded-lg bg-white hover:border-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all duration-200",value:"",children:[e.jsx("option",{value:"",children:"Change Status"}),e.jsx("option",{value:"Active",children:"Set Active"}),e.jsx("option",{value:"Inactive",children:"Set Inactive"})]}),e.jsx(ee,{variant:"danger",size:"sm",onClick:_e,className:"sm:w-auto w-full justify-center",children:"Delete Selected"})]})]})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(Je,{data:t,columns:le,isLoading:y,sorting:ae,onSortingChange:O,enableSorting:!0,enablePagination:!1,enableTableScroll:!0,tableHeight:"100%",scrollContainerRef:Y,isLoadingMore:i,showScrollToTop:!0,enableSelection:!0,selectedRows:L,onSelectionChange:U,emptyStateMessage:"No contacts found. Try adjusting your filters or search terms."})}),e.jsx(de,{isOpen:j,title:"Delete Contact",message:`Are you sure you want to delete ${T==null?void 0:T.person_name}'s contact information? This action cannot be undone.`,confirmLabel:"Delete",cancelLabel:"Cancel",confirmVariant:"danger",onConfirm:be,onCancel:()=>{M(!1),D(null)}}),e.jsx(de,{isOpen:A,title:"Delete Multiple Contacts",message:`Are you sure you want to delete ${Object.entries(L).filter(([,s])=>s).length} contacts? This action cannot be undone.`,confirmLabel:"Delete All",cancelLabel:"Cancel",confirmVariant:"danger",onConfirm:Ce,onCancel:()=>H(!1)}),e.jsx(de,{isOpen:Q,title:"Update Contact Status",message:`Are you sure you want to set ${Object.entries(L).filter(([,s])=>s).length} contacts to ${z} status?`,confirmLabel:"Update All",cancelLabel:"Cancel",confirmVariant:"warning",onConfirm:ke,onCancel:()=>{p(!1),J(null)}}),N&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-neutral-500/75 backdrop-blur-sm","aria-hidden":"true",onClick:()=>_(!1)}),e.jsx("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl h-[90vh] max-h-[90vh] overflow-hidden",children:e.jsx(es,{contact:$,onSuccess:we,onCancel:()=>_(!1)})})]})]})})})};export{us as default};
